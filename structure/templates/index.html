{% extends "base.html" %}
{% block content %}
    {# Features #}
    <nav class="navbar navbar-main navbar-expand-lg px-0 mx-4 shadow-none border-radius-xl" id="navbarBlur" navbar-scroll="true">
      <div class="container-fluid py-1 px-3">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb bg-transparent mb-0 pb-0 pt-1 px-0 me-sm-6 me-5">
            <li class="breadcrumb-item text-sm"><a class="opacity-5 text-dark" href="#">UI Editor</a></li>
            <li class="breadcrumb-item text-sm text-dark active" aria-current="page">Admin</li>
          </ol>
          <h6 class="font-weight-bolder mb-0">Dashboard</h6>
        </nav>
        <div class="collapse navbar-collapse mt-sm-0 mt-2 me-md-0 me-sm-4" id="navbar">
          <div class="ms-md-auto pe-md-3 d-flex align-items-center">
          
          </div>
          <ul class="navbar-nav  justify-content-end">
            <li class="nav-item d-flex align-items-center">
              <a href="javascript:;" class="nav-link text-body font-weight-bold px-0">
                <i class="fa fa-user me-sm-1"></i>
                <span class="d-sm-inline d-none">Sign In</span>
              </a>
            </li>
            <li class="nav-item d-xl-none ps-3 d-flex align-items-center">
              <a href="javascript:;" class="nav-link text-body p-0" id="iconNavbarSidenav">
                <div class="sidenav-toggler-inner">
                  <i class="sidenav-toggler-line"></i>
                  <i class="sidenav-toggler-line"></i>
                  <i class="sidenav-toggler-line"></i>
                </div>
              </a>
            </li>
            <li class="nav-item px-3 d-flex align-items-center">
              <a href="javascript:;" class="nav-link text-body p-0">
                <i class="fa fa-cog fixed-plugin-button-nav cursor-pointer"></i>
              </a>
            </li>
            <li class="nav-item dropdown pe-2 d-flex align-items-center">
              <a href="javascript:;" class="nav-link text-body p-0" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="fa fa-bell cursor-pointer"></i>
              </a>
              <ul class="dropdown-menu  dropdown-menu-end  px-2 py-3 me-sm-n4" aria-labelledby="dropdownMenuButton">
                <li class="mb-2">
                  <a class="dropdown-item border-radius-md" href="javascript:;">
                    <div class="d-flex py-1">
                      <div class="my-auto">
                        <img src="../assets/img/team-2.jpg" class="avatar avatar-sm  me-3 ">
                      </div>
                      <div class="d-flex flex-column justify-content-center">
                        <h6 class="text-sm font-weight-normal mb-1">
                          <span class="font-weight-bold">New message</span> from Laur
                        </h6>
                        <p class="text-xs text-secondary mb-0">
                          <i class="fa fa-clock me-1"></i>
                          13 minutes ago
                        </p>
                      </div>
                    </div>
                  </a>
                </li>
                <li class="mb-2">
                  <a class="dropdown-item border-radius-md" href="javascript:;">
                    <div class="d-flex py-1">
                      <div class="my-auto">
                        <img src="../assets/img/small-logos/logo-spotify.svg" class="avatar avatar-sm bg-gradient-dark  me-3 ">
                      </div>
                      <div class="d-flex flex-column justify-content-center">
                        <h6 class="text-sm font-weight-normal mb-1">
                          <span class="font-weight-bold">New album</span> by Travis Scott
                        </h6>
                        <p class="text-xs text-secondary mb-0">
                          <i class="fa fa-clock me-1"></i>
                          1 day
                        </p>
                      </div>
                    </div>
                  </a>
                </li>
                <li>
                  <a class="dropdown-item border-radius-md" href="javascript:;">
                    <div class="d-flex py-1">
                      <div class="avatar avatar-sm bg-gradient-secondary  me-3  my-auto">
                        <svg width="12px" height="12px" viewBox="0 0 43 36" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                          <title>credit-card</title>
                          <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                            <g transform="translate(-2169.000000, -745.000000)" fill="#FFFFFF" fill-rule="nonzero">
                              <g transform="translate(1716.000000, 291.000000)">
                                <g transform="translate(453.000000, 454.000000)">
                                  <path class="color-background" d="M43,10.7482083 L43,3.58333333 C43,1.60354167 41.3964583,0 39.4166667,0 L3.58333333,0 C1.60354167,0 0,1.60354167 0,3.58333333 L0,10.7482083 L43,10.7482083 Z" opacity="0.593633743"></path>
                                  <path class="color-background" d="M0,16.125 L0,32.25 C0,34.2297917 1.60354167,35.8333333 3.58333333,35.8333333 L39.4166667,35.8333333 C41.3964583,35.8333333 43,34.2297917 43,32.25 L43,16.125 L0,16.125 Z M19.7083333,26.875 L7.16666667,26.875 L7.16666667,23.2916667 L19.7083333,23.2916667 L19.7083333,26.875 Z M35.8333333,26.875 L28.6666667,26.875 L28.6666667,23.2916667 L35.8333333,23.2916667 L35.8333333,26.875 Z"></path>
                                </g>
                              </g>
                            </g>
                          </g>
                        </svg>
                      </div>
                      <div class="d-flex flex-column justify-content-center">
                        <h6 class="text-sm font-weight-normal mb-1">
                          Payment successfully completed
                        </h6>
                        <p class="text-xs text-secondary mb-0">
                          <i class="fa fa-clock me-1"></i>
                          2 days
                        </p>
                      </div>
                    </div>
                  </a>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- End Navbar -->
    <div class="container-fluid py-4">
      <div class="row">
        <div class="col-xl-3 col-sm-6 mb-xl-0 mb-4">
          <div class="card">
            <div class="card-body p-3">
              <div class="row">
                <div class="col-8">
                  <div class="numbers">
                    <p class="text-sm mb-0 text-capitalize font-weight-bold"></p>
                    <h5 class="font-weight-bolder mb-0">
                      Lorem ipsum dolor sit amet
             <span class="text-success text-sm font-weight-bolder"></span>

                      
                    </h5>
                  </div>
                </div>
                <div class="col-4 text-end">
                  <div class="icon icon-shape bg-gradient-primary shadow text-center border-radius-md">
                    <i class="ni ni-money-coins text-lg opacity-10" aria-hidden="true"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-xl-3 col-sm-6 mb-xl-0 mb-4">
          <div class="card">
            <div class="card-body p-3">
              <div class="row">
                <div class="col-8">
                  <div class="numbers">
                    <p class="text-sm mb-0 text-capitalize font-weight-bold"></p>
                    <h5 class="font-weight-bolder mb-0">
                      Lorem ipsum dolor sit amet<span class="text-success text-sm font-weight-bolder"></span>
    </h5>
                  </div>
                </div>
                <div class="col-4 text-end">
                  <div class="icon icon-shape bg-gradient-primary shadow text-center border-radius-md">
                    <i class="ni ni-world text-lg opacity-10" aria-hidden="true"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-xl-3 col-sm-6 mb-xl-0 mb-4">
          <div class="card">
            <div class="card-body p-3">
              <div class="row">
                <div class="col-8">
                  <div class="numbers">
                    <p class="text-sm mb-0 text-capitalize font-weight-bold"></p>
                    <h5 class="font-weight-bolder mb-0">
                      Lorem ipsum dolor sit amet<span class="text-danger text-sm font-weight-bolder"></span>
                    </h5>
                  </div>
                </div>
                <div class="col-4 text-end">
                  <div class="icon icon-shape bg-gradient-primary shadow text-center border-radius-md">
                    <i class="ni ni-paper-diploma text-lg opacity-10" aria-hidden="true"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-xl-3 col-sm-6">
          <div class="card">
            <div class="card-body p-3">
              <div class="row">
                <div class="col-8">
                  <div class="numbers">
                    <p class="text-sm mb-0 text-capitalize font-weight-bold"></p>
                    <h5 class="font-weight-bolder mb-0">
                      Lorem ipsum dolor sit amet                
                        <span class="text-success text-sm font-weight-bolder"></span>
                    </h5>
                  </div>
                </div>
                <div class="col-4 text-end">
                  <div class="icon icon-shape bg-gradient-primary shadow text-center border-radius-md">
                    <i class="ni ni-cart text-lg opacity-10" aria-hidden="true"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row mt-4">
        <div class="col-lg-7 mb-lg-0 mb-4">
          <div class="card">
            <div class="card-body p-3">
              <div class="row">
                <div class="col-lg-6">
                  <div class="d-flex flex-column h-100">
                    <p class="mb-1 pt-2 text-bold">Lorem ipsum dolor sit amet</p>
                    <h5 class="font-weight-bolder">Lorem ipsum dolor sit amet</h5>
                  <a  href="{{url_for('admins.addticket')}} "> <button class=' btn btn-primary btn-sm btn-icon'>Site Information</button></a>
                    <p class="mb-5">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. 
                      Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip</p>
                    
                  </div>
                </div>
                <div class="col-lg-5 ms-auto text-center mt-5 mt-lg-0">
                  <div class="bg-gradient-primary border-radius-lg h-100">
                    <div class="position-relative d-flex align-items-center justify-content-center h-100">
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-lg-5">
          <div class="card h-100 p-3">
            <div class="overflow-hidden position-relative border-radius-lg bg-cover h-100" style="background-image: url('../assets/img/ivancik.jpg');">
              <span class="mask bg-gradient-dark"></span>
              <div class="card-body position-relative z-index-1 d-flex flex-column h-100 p-3">
                <h5 class="text-white font-weight-bolder mb-4 pt-2">ACTIVE TEMPLATE:</h5>
                <p class="text-white">#</p>
               <a  href=""> <button class=' btn btn-primary btn-sm btn-icon'>Change template</button></a>
               <p class="text-white">Domain: None</p>
               <a  href=""> <button class=' btn btn-primary btn-sm btn-icon'>Browse Domains</button></a>


               
              </div>
            </div>
          </div>
        </div>
      </div>
<br>
<br>





                <div class="row">
        <div class="col-12">
          <div class="card mb-4">
            <div class="card-header pb-0">
              
              <div class="row">
                <div class="col-lg-6">
                  <div class="d-flex flex-column h-100">
                    <h5 class="font-weight-bolder">Now Showing Tickets</h5>
                    <p class="mb-5">Edit existing tickets or add new tickets to be displayed on your website</p>
                   
                  </div>
              </div>
            </div>
            <!--<a href="#" class="btn btn-primary btn-sm" style="float:right; vertical-align: top;">Add features</a>-->
            <a href="{{url_for('admins.addticket')}} " class="btn btn-primary btn-sm" style="float:right; vertical-align: top;">Add Ticket</a>
     
            <div class="card-body px-0 pt-0 pb-2">
              <div class="table-responsive p-0">
                <table class="table align-items-center mb-0">
                  <thead>
                    <tr>
                      <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Title</th>
                      <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Price</th>
                      <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Description</th>
                   
                      <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Actions</th>
                      <th class="text-secondary opacity-7"></th>
                    </tr>
                  </thead>
                  <tbody>
                  {% for ticket in tickets.items %}
                  {% if ticket.release_date < currentdate and ticket.display == 'yes' %}
                  <tr>
                    <td>
                      <div class="d-flex px-2 py-1">
                       
                        <div class="d-flex flex-column justify-content-center">
                          <h6 class="mb-0 text-sm">{{ticket.name}}</h6>
                        </div>
                      </div>
                    </td>
                    <td>
                      <p class="text-xs font-weight-bold mb-0">{{ ticket.price }}</p>
                    </td>
                    <td>
                      <p class="text-xs font-weight-bold mb-0">{{ ticket.description[:50] }}...</p>
                    </td>
                    
                    <td class="align-middle">
                      <a href="javascript:;" class="text-secondary font-weight-bold text-xs" data-toggle="tooltip" data-original-title="Edit user">
                        <a href="{{ url_for('admins.updateticket',ticket_id=ticket.id) }}" class="btn btn-primary">Edit Feature</a> 
                        
                        <button data-toggle="modal" data-target="#deleteticket{{ticket.id}}"  class="btn btn-danger"><i class="fa fa-edit"></i>Delete</button>
                        <div class="modal fade" id="deleteticket{{ticket.id}}" tabindex="-1" role="dialog" aria-labelledby="edittestimonial" aria-hidden="true">
                          <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                              <div class="modal-header">
                                <h5 class="modal-title" id="deleteticket{{ticket.id}}">Modal title</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                  <span aria-hidden="true">&times;</span>
                                </button>
                              </div>
                              <div class="modal-body">
                                <form action="{{ url_for('admins.delete_ticket', ticket_id=ticket.id) }}"
                                >
                                  <input class='btn btn-danger' type="submit" value="Delete">
                                  </div>
                                </form>
                              </div> 
                            </div>
                          </div>
                          </div>
                    </td>
                  </tr>
                  <tr>
                    {% endif %}
                    {% endfor %}
                    
               
                      
                  </tbody>
                </table>
              </div>
              <!-- Pagination Links-->
<div class="text-right">
  <a href="{{ url_for('admins.admin', page=tickets.prev_num) }}"
     class="btn btn-outline-dark 
     {% if tickets.page == 1 %}disabled{% endif %}">
      &laquo;
  </a><!-- Loop through the number of pages to display a link for each-->
  {% for page_num in tickets.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=2) %}{% if page_num %}
<!-- Check for the active page and set the link to "Active"-->
          {% if tickets.page == page_num %}
          <a href="{{ url_for('admins.admin', page=page_num) }}"
             class="btn btn-dark">
              {{ page_num }}
          </a>
          {% else %}
          <a href="{{ url_for('admins.admin', page=page_num) }}"
             class="btn btn-outline-dark">
              {{ page_num }}
          </a>
          {% endif %}
      {% else %}
          ...
      {% endif %}
  {% endfor %}    <a href="{{ url_for('admins.admin', page=tickets.next_num) }}"
     class="btn btn-outline-dark 
     {% if tickets.page == tickets.pages %}disabled{% endif %}">
      &raquo;
  </a>
</div>
<p class="text-right mt-3">
 Showing page {{ tickets.page }} of {{ tickets.pages }}
</p>
            </div>
          </div>
        </div>
      </div>
    </div>
<br>


<!-- Upcoming Tickets -->
<div class="row">
  <div class="col-12">
    <div class="card mb-4">
      <div class="card-header pb-0">
        
        <div class="row">
          <div class="col-lg-6">
            <div class="d-flex flex-column h-100">
              <h5 class="font-weight-bolder">Available Movies</h5>
              <p class="mb-5">Edit existing tickets or add new tickets to be displayed on your website</p>
             
            </div>
        </div>
      </div>
      <!--<a href="#" class="btn btn-primary btn-sm" style="float:right; vertical-align: top;">Add features</a>-->
      <a href="{{url_for('admins.addticket')}} " class="btn btn-primary btn-sm" style="float:right; vertical-align: top;">Add Ticket</a>

      <div class="card-body px-0 pt-0 pb-2">
        <div class="table-responsive p-0">
          <table class="table align-items-center mb-0">
            <thead>
              <tr>
                <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Title</th>
                <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Release date</th>
                <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Description</th>
                <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Released?</th>
             
                <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Actions</th>
                <th class="text-secondary opacity-7"></th>
              </tr>
            </thead>
            <tbody>
            {% for ticket in tickets.items %}
            {% if ticket.display == 'no'%}
            <tr>
              <td>
                <div class="d-flex px-2 py-1">
                 
                  <div class="d-flex flex-column justify-content-center">
                    <h6 class="mb-0 text-sm">{{ticket.name}}</h6>
                  </div>
                </div>
              </td>
              <td>
                <p class="text-xs font-weight-bold mb-0">{{ ticket.release_date }}</p>
              </td>
              <td>
                <p class="text-xs font-weight-bold mb-0">{{ ticket.description[:50] }}...</p>
              </td>
            
              <td>
                {% if ticket.release_date < currentdate %}
                <p class="text-xs font-weight-bold mb-0">    yes             
                </p>
                {% else %}
                <p class="text-xs font-weight-bold mb-0">    
                  no             
                </p>
                {% endif %}
              </td>
              
              <td class="align-middle">
                <a href="javascript:;" class="text-secondary font-weight-bold text-xs" data-toggle="tooltip" data-original-title="Edit user">
                  <a href="{{ url_for('admins.updateticket',ticket_id=ticket.id) }}" class="btn btn-primary">Edit Feature</a> 
                  
                  <button data-toggle="modal" data-target="#deleteticket{{ticket.id}}"  class="btn btn-danger"><i class="fa fa-edit"></i>Delete</button>
                  <div class="modal fade" id="deleteticket{{ticket.id}}" tabindex="-1" role="dialog" aria-labelledby="edittestimonial" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered" role="document">
                      <div class="modal-content">
                        <div class="modal-header">
                          <h5 class="modal-title" id="deleteticket{{ticket.id}}">Modal title</h5>
                          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                          </button>
                        </div>
                        <div class="modal-body">
                          <form action="{{ url_for('admins.delete_ticket', ticket_id=ticket.id) }}"
                          >
                            <input class='btn btn-danger' type="submit" value="Delete">
                            </div>
                          </form>
                        </div> 
                      </div>
                    </div>
                    </div>
              </td>
            </tr>
            <tr>
              {% endif %}
              {% endfor %}
              
         
                
            </tbody>
          </table>
        </div>
        <!-- Pagination Links-->
<div class="text-right">
<a href="{{ url_for('admins.admin', page=tickets.prev_num) }}"
class="btn btn-outline-dark 
{% if tickets.page == 1 %}disabled{% endif %}">
&laquo;
</a><!-- Loop through the number of pages to display a link for each-->
{% for page_num in tickets.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=2) %}{% if page_num %}
<!-- Check for the active page and set the link to "Active"-->
    {% if tickets.page == page_num %}
    <a href="{{ url_for('admins.admin', page=page_num) }}"
       class="btn btn-dark">
        {{ page_num }}
    </a>
    {% else %}
    <a href="{{ url_for('admins.admin', page=page_num) }}"
       class="btn btn-outline-dark">
        {{ page_num }}
    </a>
    {% endif %}
{% else %}
    ...
{% endif %}
{% endfor %}    <a href="{{ url_for('admins.admin', page=tickets.next_num) }}"
class="btn btn-outline-dark 
{% if tickets.page == tickets.pages %}disabled{% endif %}">
&raquo;
</a>
</div>
<p class="text-right mt-3">
Showing page {{ tickets.page }} of {{ tickets.pages }}
</p>
      </div>
    </div>
  </div>
</div>
</div>
<br>


<!-- orders table -->
<div class="row">
  <div class="col-12">
    <div class="card mb-4">
      <div class="card-header pb-0">
        
        <div class="row">
          <div class="col-lg-6">
            <div class="d-flex flex-column h-100">
              <h5 class="font-weight-bolder">Refunds</h5>
              <p class="mb-5">Review pending refunds</p>
             
            </div>
        </div>
      </div>
      <!--<a href="#" class="btn btn-primary btn-sm" style="float:right; vertical-align: top;">Add features</a>-->

      <div class="card-body px-0 pt-0 pb-2">
        <div class="table-responsive p-0">
          <table class="table align-items-center mb-0">
            <thead>
              <tr>
                <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Ticket</th>
                <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Quantity</th>
                <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Date</th>
                <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Refund Reason</th>
             
                <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Actions</th>
                <th class="text-secondary opacity-7"></th>
              </tr>
            </thead>
            <tbody>
            {% for order in orders %}
            {% if order.refund_granted == 'no' and order.handled == 'no' %}


            <tr>
              <td>
                <div class="d-flex px-2 py-1">
                 
                  <div class="d-flex flex-column justify-content-center">
                    <h6 class="mb-0 text-sm">{{order.ticket.name}}</h6>
             
                  </div>
                </div>
              </td>
              <td>
                <p class="text-xs font-weight-bold mb-0">{{ order.quantity }}</p>
              </td>
              <td>
                <p class="text-xs font-weight-bold mb-0">{{ order.date }}...</p>
              </td>
              <td>
                <p class="text-xs font-weight-bold mb-0">{{ order.refund_reason }}</p>
              </td>
              
              <td class="align-middle">
                <a href="javascript:;" class="text-secondary font-weight-bold text-xs" data-toggle="tooltip" data-original-title="Edit user">
                  <a href="" class="btn btn-primary">Action</a> 
                  
                  <button data-toggle="modal" data-target="#order{{order.id}}"  class="btn btn-danger"><i class="fa fa-edit"></i>Act</button>
                  <div class="modal fade" id="order{{order.id}}" tabindex="-1" role="dialog" aria-labelledby="edittestimonial" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered" role="document">
                      <div class="modal-content">
                        <div class="modal-header">
                          <h5 class="modal-title" id="order{{order.id}}">Modal title</h5>
                          
                        <div class="modal-body">
                          <p>{{order.ticket}}</p>
                          <p>{{order.refund_reason}}</p>
                          {% from "_formhelpers.html" import render_field %}

                          <form action="{{ url_for('core.approverefund', order_id=order.id) }}" method='POST'>

                            <div class="form-group">
                              {{ render_field(form.approve_refund, class="form-control") }}

                            {{ render_field(form.submit, class="form-control") }}
                            </div>
                            <span aria-hidden="true">&times;</span>
                          </button>
                        </div>
                      </form>
                            </div>

                    
                        </div> 
                      </div>
                    </div>
                    </div>
              </td>
            </tr>
            <tr>
              {% endif %}
              {% endfor %}
              
         
                
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>







<div class="row">
  <div class="col-12">
    <div class="card mb-4">
      <div class="card-header pb-0">
        
        <div class="row">
          <div class="col-lg-6">
            <div class="d-flex flex-column h-100">
              <h5 class="font-weight-bolder">Coupons</h5>
              <p class="mb-5">Edit existing tickets or add new tickets to be displayed on your website</p>
              <a href="{{ url_for('admins.addcoupon') }}" class="btn btn-primary btn-sm" style="float:right; vertical-align: top;">Add Coupon</a>

             
            </div>
        </div>
      </div>
      <!--<a href="#" class="btn btn-primary btn-sm" style="float:right; vertical-align: top;">Add features</a>-->

      <div class="card-body px-0 pt-0 pb-2">
        <div class="table-responsive p-0">
          <table class="table align-items-center mb-0">
            <thead>
              <tr>
                <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Code</th>
                <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Price</th>
                <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Status</th>
          
             
                <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Actions</th>
                <th class="text-secondary opacity-7"></th>
              </tr>
            </thead>
            <tbody>
          {% for coupons in coupon.items %}


            <tr>
              <td>
                <div class="d-flex px-2 py-1">
                 
                  <div class="d-flex flex-column justify-content-center">
                    <h6 class="mb-0 text-sm">{{coupons.code}}</h6>
             
                  </div>
                </div>
              </td>
              <td>
                <p class="text-xs font-weight-bold mb-0">{{ coupons.amount }}</p>
              </td>
              <td>
                <p class="text-xs font-weight-bold mb-0">{{ coupons.status }}</p>
              </td>
              
              <td class="align-middle">
                <a href="javascript:;" class="text-secondary font-weight-bold text-xs" data-toggle="tooltip" data-original-title="Edit user">
                  <a href="{{ url_for('admins.updatecoupon',coupon_id=coupons.id) }}" class="btn btn-primary">Edit </a> 
                  
               
                        </div>
                      </form>
                            </div>

                    
                        </div> 
                      </div>
                    </div>
                    </div>
              </td>
            </tr>
            <tr>

              {% endfor %}
         
                
            </tbody>
          </table>
        </div>
                      <!-- Pagination Links-->
<div class="text-right">
  <a href="{{ url_for('admins.admin', page=coupon.prev_num) }}"
     class="btn btn-outline-dark 
     {% if coupon.page == 1 %}disabled{% endif %}">
      &laquo;
  </a><!-- Loop through the number of pages to display a link for each-->
  {% for page_num in coupon.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=2) %}{% if page_num %}
<!-- Check for the active page and set the link to "Active"-->
          {% if coupon.page == page_num %}
          <a href="{{ url_for('admins.admin', page=page_num) }}"
             class="btn btn-dark">
              {{ page_num }}
          </a>
          {% else %}
          <a href="{{ url_for('admins.admin', page=page_num) }}"
             class="btn btn-outline-dark">
              {{ page_num }}
          </a>
          {% endif %}
      {% else %}
          ...
      {% endif %}
  {% endfor %}    <a href="{{ url_for('admins.admin', page=coupon.next_num) }}"
     class="btn btn-outline-dark 
     {% if coupon.page == coupon.pages %}disabled{% endif %}">
      &raquo;
  </a>
</div>
<p class="text-right mt-3">
 Showing page {{ coupon.page }} of {{ coupon.pages }}
</p>
            </div>
          </div>
        </div>
      </div>
    </div>
<br>
      </div>
    </div>
  </div>




    
<div class="row">
  <div class="col-12">
    <div class="card mb-4">
      <div class="card-header pb-0">
        
        <div class="row">
          <div class="col-lg-6">
            <div class="d-flex flex-column h-100">
              <h5 class="font-weight-bolder">Refunds</h5>
              <p class="mb-5">Review pending refunds</p>
             
            </div>
        </div>
      </div> 
      <!--<a href="#" class="btn btn-primary btn-sm" style="float:right; vertical-align: top;">Add features</a>-->

      <p>
        <button class="btn btn-primary" type="button" data-bs-toggle="collapse" data-bs-target="#pending" aria-expanded="false" aria-controls="handled">Pending Refunds</button> 
        <button class="btn btn-primary" type="button" data-bs-toggle="collapse" data-bs-target="#handled" aria-expanded="false" aria-controls="handled">Handled Refunds</button> 
        <button class="btn btn-primary" type="button" data-bs-toggle="collapse" data-bs-target=".multi-collapse" aria-expanded="false" aria-controls="pending handled">Toggle both elements</button>
      </p>
          <div class="collapse" id="pending">
            <div class="card card-body">
              <table class="table align-items-center mb-0">
                <thead>
                  <tr>
                    <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Ticket</th>
                    <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Quantity</th>
                    <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Date</th>
                    <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Refund Reason</th>
                 
                    <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Actions</th>
                    <th class="text-secondary opacity-7"></th>
                  </tr>
                </thead>
                <tbody>
                {% for order in orders %}
                {% if order.refund_granted == 'no' and order.handled == 'no' %} 
    
    
                <tr>
                  <td>
                    <div class="d-flex px-2 py-1">
                     
                      <div class="d-flex flex-column justify-content-center">
                        <h6 class="mb-0 text-sm">{{order.ticket.name}}</h6>
                 
                      </div>
                    </div>
                  </td>
                  <td>
                    <p class="text-xs font-weight-bold mb-0">{{ order.quantity }}</p>
                  </td>
                  <td>
                    <p class="text-xs font-weight-bold mb-0">{{ order.date }}...</p>
                  </td>
                  <td>
                    <p class="text-xs font-weight-bold mb-0">{{ order.refund_reason }}</p>
                  </td>
                  
                  <td class="align-middle">
                    <a href="javascript:;" class="text-secondary font-weight-bold text-xs" data-toggle="tooltip" data-original-title="Edit user">
                      <a href="" class="btn btn-primary">Action</a> 
                      
                      <button data-toggle="modal" data-target="#order{{order.id}}"  class="btn btn-danger"><i class="fa fa-edit"></i>Act</button>
                      <div class="modal fade" id="order{{order.id}}" tabindex="-1" role="dialog" aria-labelledby="edittestimonial" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                          <div class="modal-content">
                            <div class="modal-header">
                              <h5 class="modal-title" id="order{{order.id}}">Modal title</h5>
                              
                            <div class="modal-body">
                              <p>{{order.ticket}}</p>
                              <p>{{order.refund_reason}}</p>
                              {% from "_formhelpers.html" import render_field %}
    
                              <form action="{{ url_for('core.approverefund', order_id=order.id) }}" method='POST'>
    
                                <div class="form-group">
                                  {{ render_field(form.approve_refund, class="form-control") }}
    
                                {{ render_field(form.submit, class="form-control") }}
                                </div>
                                <span aria-hidden="true">&times;</span>
                              </button>
                            </div>
                          </form>
                                </div>
    
                        
                            </div> 
                          </div>
                        </div>
                        </div>
                  </td>
                </tr>
                <tr>
                  {% endif %}
                  {% endfor %}
                  
             
                    
                </tbody>
              </table>         
            
               </div>
          </div>
        </div>
          <div class="collapse" id="handled">
            <div class="card card-body">
              <table class="table align-items-center mb-0">
                <thead>
                  <tr>
                    <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Ticket</th>
                    <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Quantity</th>
                    <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Date</th>
                    <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Refund Reason</th>
                 
                    <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Actions</th>
                    <th class="text-secondary opacity-7"></th>
                  </tr>
                </thead>
                <tbody>
                {% for order in orders %}
                {% if order.refund_granted == 'no' and order.handled == 'yes' %}
    
    
                <tr>
                  <td>
                    <div class="d-flex px-2 py-1">
                     
                      <div class="d-flex flex-column justify-content-center">
                        <h6 class="mb-0 text-sm">{{order.ticket.name}}</h6>
                 
                      </div>
                    </div>
                  </td>
                  <td>
                    <p class="text-xs font-weight-bold mb-0">{{ order.quantity }}</p>
                  </td>
                  <td>
                    <p class="text-xs font-weight-bold mb-0">{{ order.date }}...</p>
                  </td>
                  <td>
                    <p class="text-xs font-weight-bold mb-0">{{ order.refund_reason }}</p>
                  </td>
                  
                  <td class="align-middle">
                    <a href="javascript:;" class="text-secondary font-weight-bold text-xs" data-toggle="tooltip" data-original-title="Edit user">
                      <a href="" class="btn btn-primary">Action</a> 
                      
                      <button data-toggle="modal" data-target="#order{{order.id}}"  class="btn btn-danger"><i class="fa fa-edit"></i>Act</button>
                      <div class="modal fade" id="order{{order.id}}" tabindex="-1" role="dialog" aria-labelledby="edittestimonial" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                          <div class="modal-content">
                            <div class="modal-header">
                              <h5 class="modal-title" id="order{{order.id}}">Modal title</h5>
                              
                            <div class="modal-body">
                              <p>{{order.ticket}}</p>
                              <p>{{order.refund_reason}}</p>
                              {% from "_formhelpers.html" import render_field %}
    
                              <form action="{{ url_for('core.approverefund', order_id=order.id) }}" method='POST'>
    
                                <div class="form-group">
                                  {{ render_field(form.approve_refund, class="form-control") }}
    
                                {{ render_field(form.submit, class="form-control") }}
                                </div>
                                <span aria-hidden="true">&times;</span>
                              </button>
                            </div>
                          </form>
                                </div>
    
                        
                            </div> 
                          </div>
                        </div>
                        </div>
                  </td>
                </tr>
                <tr>
                  {% endif %}
                  {% endfor %}
                  
             
                    
                </tbody>
              </table>                  </div>
          </div>
        </div>
      </div>
        
        </div>
      </div>
    </div>
  </div>
      


<div class="container">
   <br><br><br><br>
   <form class="form-inline">
     <div class="form-group">
       <label class="sr-only" for="emailInput">Email address</label>
       <input type="email" class="form-control" id="emailInput" placeholder="Email">
     </div>
     <div class="form-group">
       <label class="sr-only" for="nameInput">Name</label>
       <input type="text" class="form-control" id="nameInput" placeholder="First Name">
     </div>
     <button type="submit" class="btn btn-default">Submit</button>
   </form>
   <br>
   <div id="successAlert" class="alert alert-success" role="alert" style="display:none;"></div>
   <div id="errorAlert" class="alert alert-danger" role="alert" style="display:none;"></div>
</div>
     
<div class="table-responsive">
  <table class="table table-sm table-borderless mb-0">
      <thead class="thead-dark">
          <tr>
              <th>S/N</th>
              <th>Color Name</th>
              <th>Date Created</th>
              <th>Actions</th>
          </tr>
      </thead>
      <tbody>
          {% for genres in genre.items %}
          <tr>
              <th scope="row">{{ loop.index }}</th>
              <td>{{ genres.name }}</td>
              <td>{{ genres.created_at }}</td>
          </tr>
          {% endfor %}
      </tbody>
  </table>
</div>
<!-- Pagination Links-->
<div class="text-right">
  <a href="{{ url_for('core.index', page=genre.prev_num) }}"
     class="btn btn-outline-dark 
     {% if genre.page == 1 %}disabled{% endif %}">
      &laquo;
  </a><!-- Loop through the number of pages to display a link for each-->
  {% for page_num in genre.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=2) %}{% if page_num %}
<!-- Check for the active page and set the link to "Active"-->
          {% if genre.page == page_num %}
          <a href="{{ url_for('admins.admin', page=page_num) }}"
             class="btn btn-dark">
              {{ page_num }}
          </a>
          {% else %}
          <a href="{{ url_for('admins.admin', page=page_num) }}"
             class="btn btn-outline-dark">
              {{ page_num }}
          </a>
          {% endif %}
      {% else %}
          ...
      {% endif %}
  {% endfor %}    <a href="{{ url_for('admins.admin', page=genre.next_num) }}"
     class="btn btn-outline-dark 
     {% if genre.page == genre.pages %}disabled{% endif %}">
      &raquo;
  </a>
</div>
<p class="text-right mt-3">
 Showing page {{ genre.page }} of {{ genre.pages }}
</p>


<script>
  $(document).ready(function() {
      $('form').on('submit', function(event) {
          $.ajax({
              data : {
                  password : $('#name').val(),
                  email : $('#email'). val()
              },
              type : 'POST',
              url : '/process'
          })
          .done(function(data) {
             if (data.error) {
                 $( '#errorAlert').text(data.error).show();
                  $('#')
              }
              else {
              }
          });
          event.preventDefault();
      });
  });
  
  
  
  </script>
    
{% endblock %}
